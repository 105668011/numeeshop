(function(b){var d=b.util;if(_weq["webengage.licenseCode"]){var c="//c.webengage.com/c.jpg?v=1.0",a=(location.host.match(/[-\w]+(\.(?:[-\w]+\.xn--[-\w]+|[-\w]{3,}|[-\w]+\.[-\w]{2}))?$/i))[0],e={setGoalsCookie:function(g){var f=g||{};var h=d.stringify(f);if(h){d.setCookie("_we_wk_gls_ss_",h,"","/","."+a,"",true)}return f},getGoalsCookie:function(){var f=null,h=d.getCookie("_we_wk_gls_ss_",true);if(h){try{f=(new Function("return "+h)())}catch(g){}}return f},getAllSeenNIdsToTrack:function(h){var g=null,f=e.getGoalsCookie();if(f&&f[h]&&f[h]["snids"] instanceof Array&&f[h]["snids"].length>0){g=f[h]["snids"]}return g},getAllTakenNIdsToTrack:function(h){var g=null,f=e.getGoalsCookie();if(f&&f[h]&&f[h]["cnids"] instanceof Array&&f[h]["cnids"].length>0){g=f[h]["cnids"]}return g},getCTANIdsToTrack:function(h){var g=null,f=e.getGoalsCookie();if(f&&f[h]&&f[h]["canids"] instanceof Array&&f[h]["canids"].length>0){g=f[h]["canids"]}return g},getANIdsToTrack:function(g){var h=null,f=e.getGoalsCookie();if(f&&f[g]&&f[g]["anids"] instanceof Array&&f[g]["anids"].length>0){h=f[g]["anids"]}return h},logConversion:function(g,f){if(g){b.withELog(function(){var i="",q=d.getWebengageCookie(),r=d.getSessionCookie(),k=e.getGoalsCookie();var n=new Date();var m={id:g,licenseCode:_weq["webengage.licenseCode"],tzo:(f.tzo||0),suid:r.suid,luid:q.luid,url:window.location.href,rf:r.referrer||"",lp:r.landingPage||"",ctry:r.country||"",rg:r.region||"",cty:r.city||"",b:b.BrowserDetect.browser(),bv:b.BrowserDetect.version(),os:b.BrowserDetect.os(),dvc:b.BrowserDetect.device()};var j=e.getAllSeenNIdsToTrack(g),h=e.getAllTakenNIdsToTrack(g),o=e.getCTANIdsToTrack(g),l=e.getANIdsToTrack(g);if(j&&j.length>0){m.snids=j}if(h&&h.length>0){m.cnids=h}if(o&&o.length>0){m.canids=o}if(l&&l.length>0){m.anids=l}if(_weq["webengage.conversion.data"]&&!b.util.isEmptyObject(_weq["webengage.conversion.data"])){m.cnvd=_weq["webengage.conversion.data"]}if((_weq["webengage.customData"]&&!b.util.isEmptyObject(_weq["webengage.customData"]))||(_weq["webengage.notification.customData"]&&!b.util.isEmptyObject(_weq["webengage.notification.customData"]))||(_weq["webengage.survey.customData"]&&!b.util.isEmptyObject(_weq["webengage.survey.customData"]))){var s=_weq["webengage.customData"]||{};d.copy(s,(_weq["webengage.survey.customData"]||{}),true);d.copy(s,(_weq["webengage.notification.customData"]||{}),true);m.cd=s}var p=new Image();p.src=c+"&data="+encodeURIComponent(b.util.stringify(m));if(k&&k[g]){k[g]["snids"]=null;k[g]["cnids"]=null;k[g]["canids"]=null;e.setGoalsCookie(k)}},null,true)}}};b.withELog(function(){_weq["webengage.conversion.start"]=function(f){b.withELog(function(){if(f&&f.goals&&f.goals instanceof Array){_weq["webengage.enableCallbacks"]=true;function k(o){var n=["run","open","click"];for(var m=0;m<n.length;m++){b.notification.attachEventListner(n[m],function(s){if(s.notificationId){var i=e.getGoalsCookie(),i=i||{};var r=b.util.getSessionCookie();i[o]=i[o]||{};if("open"===s.event){if(typeof s.isClickable==="boolean"&&s.isClickable){i[o]["canids"]=i[o]["canids"]||[];if(i[o]["canids"].indexOf(s.notificationId)<0){i[o]["canids"].push(s.notificationId)}}else{i[o]["snids"]=i[o]["snids"]||[];if(i[o]["snids"].indexOf(s.notificationId)<0){i[o]["snids"].push(s.notificationId)}}e.setGoalsCookie(i)}else{if("click"===s.event){i[o]["cnids"]=i[o]["cnids"]||[];if(i[o]["cnids"].indexOf(s.notificationId)<0){i[o]["cnids"].push(s.notificationId)}e.setGoalsCookie(i)}else{if("run"===s.event){if(typeof s.showOnExit==="boolean"&&!s.showOnExit){var t=b.ruleExecutor.util.sampling(s.notificationId);if(t<=95){return true}else{i[o]["anids"]=i[o]["anids"]||[];if(i[o]["anids"].indexOf(s.notificationId)<0){i[o]["anids"].push(s.notificationId);e.setGoalsCookie(i)}var q=d.getWebengageCookie(),u=false;q.anids=(q.anids?q.anids:"");if(q.anids.indexOf(s.notificationId)<0){u=true;q.anids+="##"+s.notificationId;d.setWebengageCookie(q)}var p=d.getSessionCookie();d.tsTracking("/n.jpg",("id="+s.notificationId+"&licenseCode="+_weq["webengage.licenseCode"]+"&av=1&auv="+(u?1:0)+(!p.asn?"&asn=0":"")+"&tzo="+webengage_fs_configurationMap.tzo));p.asn=1;d.updateSessionCookie(p);return false}}}}}}})}}for(var j=0;j<f.goals.length;j++){var h=f.goals[j];var l=h.value;var g=b.ruleExecutor.execute("",l,(_weq["webengage.conversion.data"]||{}));if(g){e.logConversion(h.id,f)}k(h.id)}}},null,true)}},null,true)}})(webengage);